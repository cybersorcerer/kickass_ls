{
  "name": "Memory Leak Detection Test",
  "description": "Ensure no memory leaks in long-running server sessions",
  "setup": {
    "serverPath": "/Users/Ronald.Funk/My_Documents/source/gitlab/c64.nvim/6510lsp_server",
    "serverArgs": [],
    "rootPath": "/Users/Ronald.Funk/My_Documents/source/gitlab/c64.nvim/test-cases",
    "files": {
      "memory_test.asm": "start:\n    lda #$01\n    sta $d020\n    inc $d021\n    rts"
    }
  },
  "testCases": [
    {
      "name": "Memory usage stability",
      "description": "Verify memory doesn't grow excessively with repeated operations",
      "type": "memory",
      "action": "repeatOperations",
      "operations": [
        {"type": "textDocument/didOpen", "iterations": 50, "file": "memory_test.asm"},
        {"type": "textDocument/completion", "iterations": 100, "line": 1, "character": 5},
        {"type": "textDocument/hover", "iterations": 50, "line": 2, "character": 8},
        {"type": "textDocument/didClose", "iterations": 50, "file": "memory_test.asm"}
      ],
      "expected": {
        "memoryGrowth": "<10MB",
        "finalMemory": "<200MB"
      }
    },
    {
      "name": "No memory leaks after file operations",
      "description": "Verify memory is properly released after file operations",
      "type": "memory",
      "action": "fileOperationCycle",
      "input": {
        "cycles": 20,
        "operations": ["open", "edit", "completion", "close"]
      },
      "expected": {
        "memoryIncrease": "<5%",
        "finalMemory": "<150MB"
      }
    },
    {
      "name": "Long-running session stability",
      "description": "Verify server remains stable during extended use",
      "type": "memory",
      "action": "longRunningSession",
      "input": {
        "duration": "60s",
        "operationsPerSecond": 2
      },
      "expected": {
        "crashes": 0,
        "memoryGrowth": "<20MB",
        "responseTimeDegrade": "<50%"
      }
    }
  ]
}